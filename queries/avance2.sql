SQL> start 1
SQL> --1
SQL> SELECT * FROM (
  2    SELECT 'Pelicula' Tipo, m.title Titulo,
  3    EXTRACT(YEAR FROM m.year) Lanzamiento,
  4    c.name Pais,
  5    (SELECT LISTAGG(g.name, ', ') WITHIN GROUP (ORDER BY g.name) FROM genre g
  6  	 INNER JOIN movie_genre mg ON mg.genre_id = g.id
  7  	 WHERE mg.movie_id = m.id
  8    ) Generos,
  9    (SELECT LISTAGG(a.name || ' ' || a.last_name, ', ') WITHIN GROUP (ORDER BY a.name || ' ' || a.last_name) FROM artist a
 10  	 INNER JOIN cast_movie cm ON cm.artist_id = a.id
 11  	 INNER JOIN cast_movie_role cmr ON cmr.cast_movie_id = cm.id
 12  	 WHERE cm.movie_id = m.id AND cmr.role_id = 3
 13    ) Directores
 14    FROM movie m
 15    INNER JOIN country c ON c.id = m.country_id
 16    UNION
 17    SELECT 'Serie' Tipo, s.title Titulo,
 18    EXTRACT(YEAR FROM s.begin_date) Lanzamiento,
 19    c.name Pais,
 20    (SELECT LISTAGG(g.name, ', ') WITHIN GROUP (ORDER BY g.name) FROM genre g
 21  	 INNER JOIN serie_genre sg ON sg.genre_id = g.id
 22  	 WHERE sg.serie_id = s.id
 23    ) Generos,
 24    (SELECT LISTAGG(a.name || ' ' || a.last_name, ', ') WITHIN GROUP (ORDER BY a.name || ' ' || a.last_name) FROM artist a
 25  	 INNER JOIN cast_serie cs ON cs.artist_id = a.id
 26  	 INNER JOIN cast_serie_role csr ON csr.cast_serie_id = cs.id
 27  	 WHERE cs.serie_id = s.id AND csr.role_id = 3
 28    ) Directores
 29    FROM serie s
 30    INNER JOIN country c ON c.id = s.country_id
 31  );

TIPO     TITULO                                             LANZAMIENTO PAIS                 GENEROS                                            DIRECTORES                                                                                                                                                                                                                                                                                                                                                          
-------- -------------------------------------------------- ----------- -------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                
Pelicula Avatar                                                    1976 Brasil               Aventura, Biografía, Romance, Terror              Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula Avengers: Endgame                                         1985 Panamá              Comedia, Crimen, Historia, Terror                  Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula Avengers: Infinity War                                    1995 Estados Unidos       Acción, Ciencia, Drama, Romance                   Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula Casablanca                                                1964 Costa Rica           Ciencia, Comedia, Crimen, Drama                    Jake Gyllenhaal, Jennifer Aniston, Meryl Streep                                                                                                                                                                                                                                                                                                                     
Pelicula Ciudadano Kane                                            1984 Costa Rica           Ciencia ficción, Comedia, Historia, Naturaleza    Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula Dr. No                                                    1969 Brasil               Aventura, Ciencia, Crimen, Drama                   Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula El Padrino II                                             1987 Estados Unidos       Acción, Ciencia ficción, Historia, Romance       Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula El Prisionero de Azkaban                                  1963 Costa Rica           Aventura, Biografía, Crimen, Drama                Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula El Senor de los Anillos: La Comunidad del Anillo          1989 Panamá              Acción, Ciencia, Naturaleza, Terror               Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula El Señor de los Anillos: El retorno del rey              1962 Estados Unidos       Ciencia, Ciencia ficción, Comedia, Naturaleza     Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula El Señor de los Anillos: Las dos torres                  1970 Estados Unidos       Comedia, Crimen, Drama, Historia                   Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula El caballero oscuro                                       1982 Costa Rica           Aventura, Biografía, Romance, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula El gran Lebowski                                          1963 Costa Rica           Ciencia, Ciencia ficción, Comedia, Crimen         Meryl Streep, Tom Hardy                                                                                                                                                                                                                                                                                                                                             
Pelicula El laberinto del fauno                                    1970 Estados Unidos       Biografía, Comedia, Crimen, Terror                Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula El padrino                                                1982 Costa Rica           Ciencia, Comedia, Crimen, Terror                   Daniel Day-Lewis, Julia Roberts, Sean Penn                                                                                                                                                                                                                                                                                                                          
Pelicula En llamas                                                 1997 Brasil               Comedia, Crimen, Drama, Historia                   Mark Wahlberg, Meryl Streep                                                                                                                                                                                                                                                                                                                                         
Pelicula Fast Five                                                 1964 Costa Rica           Ciencia, Comedia, Drama, Romance                   Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula Fast and Furious 6                                        1967 Costa Rica           Ciencia, Comedia, Romance, Terror                  Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula Forrest Gump                                              1997 Brasil               Aventura, Ciencia ficción, Historia, Naturaleza   Charlize Theron, Tom Hanks                                                                                                                                                                                                                                                                                                                                          
Pelicula Goldfinger                                                1988 Estados Unidos       Acción, Biografía, Naturaleza, Terror            Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Pelicula Harry Potter                                              1989 Estados Unidos       Biografía, Comedia, Crimen, Terror                Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula Indiana Jones: En busca del arca perdida                  1976 Costa Rica           Comedia, Drama, Historia, Naturaleza               Denzel Washington, Samuel L. Jackson                                                                                                                                                                                                                                                                                                                                
Pelicula Iron Man                                                  1996 Panamá              Biografía, Ciencia ficción, Comedia, Crimen      Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula Jurassic Park                                             1979 Panamá              Acción, Ciencia, Ciencia ficción, Romance        Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula La Cámara Secreta                                        1986 Brasil               Aventura, Ciencia ficción, Historia, Romance      Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula La Piedra Filosofal                                       1974 Estados Unidos       Ciencia, Comedia, Romance, Terror                  Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula La forma del agua                                         1982 Costa Rica           Comedia, Historia, Romance, Terror                 Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula La lista de Schindler                                     1990 Estados Unidos       Ciencia, Comedia, Crimen, Drama                    Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Pelicula La vida es bella                                          1975 Panamá              Aventura, Ciencia, Crimen, Terror                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Pelicula Los juegos del hambre                                     1997 Costa Rica           Biografía, Comedia, Drama, Naturaleza             Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula Pulp Fiction                                              1967 Costa Rica           Aventura, Ciencia, Ciencia ficción, Romance       Michael Fassbender, Robert De Niro                                                                                                                                                                                                                                                                                                                                  
Pelicula Sinsajo - Parte 1                                         1977 Panamá              Aventura, Biografía, Romance, Terror              Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Pelicula Star Wars: Episodio I                                     1997 Costa Rica           Comedia, Drama, Historia, Romance                  Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula Star Wars: Episodio IV                                    1978 Costa Rica           Aventura, Drama, Historia, Romance                 Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Pelicula Star Wars: Episodio V                                     1979 Brasil               Comedia, Crimen, Drama, Historia                   Julia Roberts, Michael Fassbender                                                                                                                                                                                                                                                                                                                                   
Pelicula Star Wars: Episodio VI                                    1975 Brasil               Aventura, Ciencia ficción, Crimen, Historia       Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula The Fast and the Furious                                  1976 Panamá              Acción, Biografía, Ciencia ficción, Romance     Tom Hanks                                                                                                                                                                                                                                                                                                                                                           

TIPO     TITULO                                             LANZAMIENTO PAIS                 GENEROS                                            DIRECTORES                                                                                                                                                                                                                                                                                                                                                          
-------- -------------------------------------------------- ----------- -------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                
Pelicula The Lost World: Jurassic Park                             1969 Costa Rica           Acción, Ciencia, Crimen, Drama                    Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Pelicula Thunderball                                               1971 Costa Rica           Comedia, Drama, Historia, Romance                  Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Pelicula Titanic                                                   1982 Brasil               Aventura, Ciencia, Crimen, Drama                   Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    Arrow                                                     1967 Panamá              Comedia, Drama, Historia, Naturaleza               Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    Black Mirror                                              1968 Estados Unidos       Ciencia ficción, Comedia, Crimen, Historia        Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Serie    Breaking Bad                                              1985 Brasil               Acción, Ciencia, Ciencia ficción, Crimen         Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    CSI: Las Vegas                                            1990 Brasil               Acción, Ciencia ficción, Crimen, Historia        Charlize Theron, Julia Roberts                                                                                                                                                                                                                                                                                                                                      
Serie    CSI: Miami                                                1973 Panamá              Aventura, Biografía, Drama, Naturaleza            Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    Chernobyl                                                 1965 Brasil               Biografía, Ciencia ficción, Comedia, Naturaleza  Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    Fear the Walking Dead                                     2015 Brasil               Acción, Ciencia, Drama, Naturaleza                Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    Friends                                                   1987 Costa Rica           Comedia, Historia, Naturaleza, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    Game of Thrones                                           1986 Estados Unidos       Acción, Ciencia, Ciencia ficción, Naturaleza     Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Greys Anatomy                                             1995 Estados Unidos       Biografía, Comedia, Naturaleza, Terror            George Clooney, Tom Hanks                                                                                                                                                                                                                                                                                                                                           
Serie    Hawkeye                                                   1967 Estados Unidos       Acción, Crimen, Historia, Terror                  Meryl Streep, Russell Crowe                                                                                                                                                                                                                                                                                                                                         
Serie    How I Met Your Mother                                     1989 Costa Rica           Acción, Biografía, Naturaleza, Terror            Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Juego de Tronos                                           1967 Panamá              Ciencia, Ciencia ficción, Comedia, Crimen         Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    Law and Order                                             1980 Brasil               Ciencia ficción, Comedia, Historia, Naturaleza    Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Law and Order: Special Victims Unit                       1997 Costa Rica           Aventura, Biografía, Ciencia ficción, Naturaleza Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Legends of Tomorrow                                       1974 Panamá              Aventura, Ciencia, Ciencia ficción, Crimen        Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    Loki                                                      1993 Estados Unidos       Aventura, Biografía, Crimen, Terror               Al Pacino, Denzel Washington                                                                                                                                                                                                                                                                                                                                        
Serie    Lost                                                      1966 Estados Unidos       Biografía, Comedia, Naturaleza, Terror            Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    Mindhunter                                                1967 Brasil               Aventura, Drama, Historia, Naturaleza              Christian Bale, Meryl Streep                                                                                                                                                                                                                                                                                                                                        
Serie    Money Heist                                               1969 Brasil               Biografía, Comedia, Naturaleza, Terror            Cate Blanchett, Julia Roberts                                                                                                                                                                                                                                                                                                                                       
Serie    Narcos                                                    1968 Costa Rica           Ciencia, Ciencia ficción, Comedia, Crimen         Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Peaky Blinders                                            1993 Estados Unidos       Biografía, Comedia, Drama, Naturaleza             Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    Star Trek Deep Space Nine                                 1962 Estados Unidos       Comedia, Crimen, Historia, Terror                  Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Star Trek The Next Generation                             1966 Panamá              Aventura, Ciencia, Drama, Romance                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    Star Trek The Original Series                             1974 Costa Rica           Biografía, Comedia, Naturaleza, Terror            Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Stranger Things                                           1977 Estados Unidos       Acción, Biografía, Ciencia ficción, Naturaleza  Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    The Big Bang Theory                                       1995 Estados Unidos       Ciencia, Ciencia ficción, Comedia, Crimen         Tom Hanks                                                                                                                                                                                                                                                                                                                                                           
Serie    The Crown                                                 1982 Estados Unidos       Comedia, Drama, Historia, Naturaleza               Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    The Flash                                                 1968 Brasil               Acción, Ciencia, Drama, Romance                   Al Pacino, Robert De Niro                                                                                                                                                                                                                                                                                                                                           
Serie    The Good Place                                            1975 Estados Unidos       Aventura, Ciencia, Drama, Naturaleza               Denzel Curry, Meryl Streep                                                                                                                                                                                                                                                                                                                                          
Serie    The Mandalorian                                           1968 Costa Rica           Biografía, Comedia, Drama, Romance                Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    The Office                                                1979 Brasil               Biografía, Comedia, Crimen, Terror                Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    The Simpsons                                              1967 Panamá              Comedia, Crimen, Historia, Terror                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                   
Serie    The Sopranos                                              1976 Estados Unidos       Comedia, Drama, Historia, Naturaleza               Robert De Niro                                                                                                                                                                                                                                                                                                                                                      

TIPO     TITULO                                             LANZAMIENTO PAIS                 GENEROS                                            DIRECTORES                                                                                                                                                                                                                                                                                                                                                          
-------- -------------------------------------------------- ----------- -------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                
Serie    The Walking Dead                                          2011 Panamá              Acción, Ciencia ficción, Historia, Romance       Tom Hanks, Viola Davis                                                                                                                                                                                                                                                                                                                                              
Serie    The Witcher                                               1992 Estados Unidos       Aventura, Biografía, Romance, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                       
Serie    True Detective                                            1976 Costa Rica           Acción, Biografía, Ciencia ficción, Crimen      Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Vikings                                                   1963 Estados Unidos       Aventura, Biografía, Crimen, Terror               Robert De Niro                                                                                                                                                                                                                                                                                                                                                      
Serie    WandaVision                                               1989 Estados Unidos       Acción, Crimen, Historia, Terror                  Meryl Streep                                                                                                                                                                                                                                                                                                                                                        
Serie    Westworld                                                 1965 Estados Unidos       Biografía, Comedia, Crimen, Drama                 Julia Roberts, Kate Winslet                                                                                                                                                                                                                                                                                                                                         

80 rows selected.

SQL> start 2
SQL> --2
SQL> SELECT * FROM (
  2    SELECT 'Serie' Tipo, s.title Titulo,
  3    EXTRACT(YEAR FROM s.begin_date) Lanzamiento,
  4    s.seasons Temporadas,
  5    (SELECT LISTAGG(g.name, ', ') WITHIN GROUP (ORDER BY g.name) FROM genre g
  6  	 INNER JOIN serie_genre sg ON sg.genre_id = g.id
  7  	 WHERE sg.serie_id = s.id
  8    ) Generos,
  9    (SELECT LISTAGG(a.name || ' ' || a.last_name, ', ') WITHIN GROUP (ORDER BY a.name || ' ' || a.last_name) FROM artist a
 10  	 INNER JOIN cast_serie cs ON cs.artist_id = a.id
 11  	 INNER JOIN cast_serie_role csr ON csr.cast_serie_id = cs.id
 12  	 WHERE cs.serie_id = s.id AND csr.role_id = 3
 13    ) Directores
 14    FROM serie s
 15    UNION
 16    SELECT 'Documental' Tipo, d.title Titulo,
 17    EXTRACT(YEAR FROM d.begin_date) Lanzamiento,
 18    d.seasons Temporadas,
 19    (SELECT LISTAGG(g.name, ', ') WITHIN GROUP (ORDER BY g.name) FROM genre g
 20  	 INNER JOIN documentary_genre dg ON dg.genre_id = g.id
 21  	 WHERE dg.documentary_id = d.id
 22    ) Generos,
 23    (SELECT LISTAGG(a.name || ' ' || a.last_name, ', ') WITHIN GROUP (ORDER BY a.name || ' ' || a.last_name) FROM artist a
 24  	 INNER JOIN cast_documentary cd ON cd.artist_id = a.id
 25  	 INNER JOIN cast_documentary_role cdr ON cdr.cast_documentary_id = cd.id
 26  	 WHERE cd.documentary_id = d.id AND cdr.role_id = 3
 27    ) Directores
 28    FROM documentary d
 29  );

TIPO       TITULO                                             LANZAMIENTO TEMPORADAS GENEROS                                            DIRECTORES                                                                                                                                                                                                                                                                                                                                                                  
---------- -------------------------------------------------- ----------- ---------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                        
Documental 13th                                                      1960          4 Aventura, Ciencia, Drama, Romance                  Robert De Niro, Scarlett Johansson                                                                                                                                                                                                                                                                                                                                          
Documental A Spacetime Odyssey                                       1994          3 Acción, Ciencia, Drama, Naturaleza                Tom Hanks                                                                                                                                                                                                                                                                                                                                                                   
Documental Amy                                                       1962          1 Biografía, Ciencia ficción, Comedia, Crimen      Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Documental Blackfish                                                 1979          2 Aventura, Ciencia, Naturaleza, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental Blue Planet II:                                           1985          2 Acción, Ciencia, Crimen, Drama                    Cate Blanchett, Denzel Washington                                                                                                                                                                                                                                                                                                                                           
Documental Citizenfour                                               1974          4 Acción, Historia, Romance, Terror                 Penélope Cruz, Robert De Niro, Sandra Bullock                                                                                                                                                                                                                                                                                                                              
Documental Cosmos                                                    1985          3 Acción, Ciencia, Crimen, Drama                    Tom Hanks                                                                                                                                                                                                                                                                                                                                                                   
Documental Exit Through the Gift Shop                                1970          4 Aventura, Historia, Romance, Terror                Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental Free Solo                                                 1964          4 Acción, Biografía, Romance, Terror               Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Documental Grizzly Man                                               1969          1 Biografía, Comedia, Crimen, Drama                 Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental Hoop Dreams                                               1992          2 Aventura, Ciencia, Drama, Naturaleza               Tom Hanks                                                                                                                                                                                                                                                                                                                                                                   
Documental Icarus                                                    1967          4 Aventura, Ciencia, Romance, Terror                 Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Documental Jiro Dreams of Sushi                                      1973          1 Ciencia ficción, Comedia, Historia, Naturaleza    Anne Hathaway, Tom Hanks                                                                                                                                                                                                                                                                                                                                                    
Documental Man on Wire                                               1992          3 Aventura, Crimen, Historia, Terror                 Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental March of the Penguins                                     1974          2 Acción, Drama, Historia, Naturaleza               Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Documental O.J.                                                      1985          4 Biografía, Comedia, Naturaleza, Terror            Samuel L. Jackson, Tom Hanks                                                                                                                                                                                                                                                                                                                                                
Documental Planet Earth                                              1992          1 Acción, Biografía, Crimen, Terror                Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental Planet Earth II:                                          1964          2 Comedia, Historia, Romance, Terror                 Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental RBG                                                       1961          4 Ciencia, Comedia, Romance, Terror                  Christian Bale, Hugh Jackman, Tom Hanks                                                                                                                                                                                                                                                                                                                                     
Documental Searching for Sugar Man                                   1993          3 Biografía, Comedia, Drama, Naturaleza             Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Documental Senna                                                     1971          1 Comedia, Drama, Historia, Naturaleza               Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental Supersize Me                                              1982          2 Acción, Biografía, Naturaleza, Terror            Julia Roberts, Russell Crowe                                                                                                                                                                                                                                                                                                                                                
Documental The Act of Killing                                        1991          3 Acción, Biografía, Ciencia ficción, Crimen      Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental The Architecture of Happiness:                            1993          3 Biografía, Comedia, Drama, Naturaleza             Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental The Cove                                                  1990          3 Ciencia ficción, Comedia, Historia, Naturaleza    Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Documental The Fog of War                                            1995          2 Aventura, Ciencia ficción, Historia, Romance      Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental The Phenomenon                                            1974          3 Acción, Ciencia, Ciencia ficción, Crimen         Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Documental Tiny House Nation                                         1978          3 Aventura, Biografía, Drama, Romance               Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental UFO                                                       1960          2 Comedia, Drama, Historia, Romance                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Documental Voyager in Space                                          1993          3 Biografía, Comedia, Romance, Terror               Mark Wahlberg, Meryl Streep                                                                                                                                                                                                                                                                                                                                                 
Serie      Arrow                                                     1967          4 Comedia, Drama, Historia, Naturaleza               Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      Black Mirror                                              1968          1 Ciencia ficción, Comedia, Crimen, Historia        Tom Hanks                                                                                                                                                                                                                                                                                                                                                                   
Serie      Breaking Bad                                              1985          2 Acción, Ciencia, Ciencia ficción, Crimen         Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Serie      CSI: Las Vegas                                            1990          1 Acción, Ciencia ficción, Crimen, Historia        Charlize Theron, Julia Roberts                                                                                                                                                                                                                                                                                                                                              
Serie      CSI: Miami                                                1973          5 Aventura, Biografía, Drama, Naturaleza            Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      Chernobyl                                                 1965          9 Biografía, Ciencia ficción, Comedia, Naturaleza  Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      Fear the Walking Dead                                     2015          9 Acción, Ciencia, Drama, Naturaleza                Denzel Washington                                                                                                                                                                                                                                                                                                                                                           

TIPO       TITULO                                             LANZAMIENTO TEMPORADAS GENEROS                                            DIRECTORES                                                                                                                                                                                                                                                                                                                                                                  
---------- -------------------------------------------------- ----------- ---------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                        
Serie      Friends                                                   1987          5 Comedia, Historia, Naturaleza, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Serie      Game of Thrones                                           1986          2 Acción, Ciencia, Ciencia ficción, Naturaleza     Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Greys Anatomy                                             1995          8 Biografía, Comedia, Naturaleza, Terror            George Clooney, Tom Hanks                                                                                                                                                                                                                                                                                                                                                   
Serie      Hawkeye                                                   1967          5 Acción, Crimen, Historia, Terror                  Meryl Streep, Russell Crowe                                                                                                                                                                                                                                                                                                                                                 
Serie      How I Met Your Mother                                     1989          9 Acción, Biografía, Naturaleza, Terror            Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Juego de Tronos                                           1967          7 Ciencia, Ciencia ficción, Comedia, Crimen         Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Serie      Law and Order                                             1980          1 Ciencia ficción, Comedia, Historia, Naturaleza    Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Law and Order: Special Victims Unit                       1997          5 Aventura, Biografía, Ciencia ficción, Naturaleza Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Legends of Tomorrow                                       1974          6 Aventura, Ciencia, Ciencia ficción, Crimen        Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      Loki                                                      1993          8 Aventura, Biografía, Crimen, Terror               Al Pacino, Denzel Washington                                                                                                                                                                                                                                                                                                                                                
Serie      Lost                                                      1966          7 Biografía, Comedia, Naturaleza, Terror            Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      Mindhunter                                                1967          2 Aventura, Drama, Historia, Naturaleza              Christian Bale, Meryl Streep                                                                                                                                                                                                                                                                                                                                                
Serie      Money Heist                                               1969          6 Biografía, Comedia, Naturaleza, Terror            Cate Blanchett, Julia Roberts                                                                                                                                                                                                                                                                                                                                               
Serie      Narcos                                                    1968          1 Ciencia, Ciencia ficción, Comedia, Crimen         Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Peaky Blinders                                            1993          9 Biografía, Comedia, Drama, Naturaleza             Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      Star Trek Deep Space Nine                                 1962          6 Comedia, Crimen, Historia, Terror                  Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Star Trek The Next Generation                             1966          4 Aventura, Ciencia, Drama, Romance                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      Star Trek The Original Series                             1974          5 Biografía, Comedia, Naturaleza, Terror            Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Stranger Things                                           1977          8 Acción, Biografía, Ciencia ficción, Naturaleza  Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      The Big Bang Theory                                       1995          9 Ciencia, Ciencia ficción, Comedia, Crimen         Tom Hanks                                                                                                                                                                                                                                                                                                                                                                   
Serie      The Crown                                                 1982          9 Comedia, Drama, Historia, Naturaleza               Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      The Flash                                                 1968          4 Acción, Ciencia, Drama, Romance                   Al Pacino, Robert De Niro                                                                                                                                                                                                                                                                                                                                                   
Serie      The Good Place                                            1975          9 Aventura, Ciencia, Drama, Naturaleza               Denzel Curry, Meryl Streep                                                                                                                                                                                                                                                                                                                                                  
Serie      The Mandalorian                                           1968          4 Biografía, Comedia, Drama, Romance                Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Serie      The Office                                                1979          1 Biografía, Comedia, Crimen, Terror                Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      The Simpsons                                              1967          8 Comedia, Crimen, Historia, Terror                  Denzel Washington                                                                                                                                                                                                                                                                                                                                                           
Serie      The Sopranos                                              1976          3 Comedia, Drama, Historia, Naturaleza               Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      The Walking Dead                                          2011          4 Acción, Ciencia ficción, Historia, Romance       Tom Hanks, Viola Davis                                                                                                                                                                                                                                                                                                                                                      
Serie      The Witcher                                               1992          7 Aventura, Biografía, Romance, Terror              Julia Roberts                                                                                                                                                                                                                                                                                                                                                               
Serie      True Detective                                            1976          7 Acción, Biografía, Ciencia ficción, Crimen      Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Vikings                                                   1963          3 Aventura, Biografía, Crimen, Terror               Robert De Niro                                                                                                                                                                                                                                                                                                                                                              
Serie      WandaVision                                               1989         10 Acción, Crimen, Historia, Terror                  Meryl Streep                                                                                                                                                                                                                                                                                                                                                                
Serie      Westworld                                                 1965          7 Biografía, Comedia, Crimen, Drama                 Julia Roberts, Kate Winslet                                                                                                                                                                                                                                                                                                                                                 

70 rows selected.

SQL> start 3
SQL> --3
SQL> SELECT c.name Nombre, c.last_name Apellidos, COUNT(DISTINCT rd.id) Documentales, COUNT(DISTINCT rm.id) Peliculas, COUNT(DISTINCT rs.id) Series
  2  FROM client c
  3  INNER JOIN reproduction_documentary rd ON rd.client_id = c.id
  4  INNER JOIN reproduction_movie rm ON rm.client_id = c.id
  5  INNER JOIN reproduction_serie rs ON rs.client_id = c.id
  6  GROUP BY c.name, c.last_name;

NOMBRE                         APELLIDOS                      DOCUMENTALES  PELICULAS     SERIES                                                                                                                                                                                                                                                                                                                                                                                                                    
------------------------------ ------------------------------ ------------ ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                    
Maxi                           Nerea Salas Morante                       1          3          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Reyes                          Matas Morales                             1          1          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Vilma                          Galindo Riba                              1          2          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Abilio                         Nadal Contreras                           3          2          3                                                                                                                                                                                                                                                                                                                                                                                                                    
Sandra                         Plana Salazar                             1          1          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Gerardo                        Salas Valenzuela                          1          3          3                                                                                                                                                                                                                                                                                                                                                                                                                    
Haroldo                        Grande Ballesteros                        4          3          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Javiera                        Bermudez                                  1          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    
José                          María Oller Carrera                      2          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Modesto                        Botella Campo                             4          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Adelaida                       Borrás Rosado                            3          3          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Jesús                         Leal Jaume                                1          3          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Jesús                         Castells Flor                             2          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Maricela                       Abril Millán Molins                      1          1          5                                                                                                                                                                                                                                                                                                                                                                                                                    
Olegario                       Prieto-Quevedo                            2          1          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Francisca                      Esther Solís Guzman                      3          2          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Fátima                        de Company                                2          1          2                                                                                                                                                                                                                                                                                                                                                                                                                    
Magdalena                      Bermúdez Prat                            1          2          4                                                                                                                                                                                                                                                                                                                                                                                                                    
Wálter                        Abella                                    1          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    
Jeremías                      Pérez-Vilalta                            1          2          3                                                                                                                                                                                                                                                                                                                                                                                                                    
Visitación                    Malena Cuervo Bravo                       2          1          1                                                                                                                                                                                                                                                                                                                                                                                                                    

21 rows selected.

SQL> start 4
SQL> WITH movie_genres_cte AS (
  2    SELECT mg.movie_id, LISTAGG(g.name, ', ') WITHIN GROUP (ORDER BY g.name) AS generos
  3    FROM movie_genre mg
  4    INNER JOIN genre g ON g.id = mg.genre_id
  5    GROUP BY mg.movie_id
  6  )
  7  SELECT
  8    m.title AS Titulo,
  9    EXTRACT(YEAR FROM m.year) AS Lanzamiento,
 10    mgc.generos AS Generos,
 11    COUNT(DISTINCT rm.id) AS Reproducciones
 12  FROM movie m
 13  INNER JOIN movie_language ml ON ml.movie_id = m.id
 14  INNER JOIN reproduction_movie rm ON rm.movie_language_id = ml.id
 15  INNER JOIN client c ON c.id = rm.client_id
 16  LEFT JOIN movie_genres_cte mgc ON mgc.movie_id = m.id
 17  GROUP BY m.title, mgc.generos, EXTRACT(YEAR FROM m.year);

TITULO                                             LANZAMIENTO GENEROS                                            REPRODUCCIONES                                                                                                                                                                                                                                                                                                                                                                                    
-------------------------------------------------- ----------- -------------------------------------------------- --------------                                                                                                                                                                                                                                                                                                                                                                                    
En llamas                                                 1997 Comedia, Crimen, Drama, Historia                                2                                                                                                                                                                                                                                                                                                                                                                                    
El gran Lebowski                                          1963 Ciencia, Ciencia ficción, Comedia, Crimen                      1                                                                                                                                                                                                                                                                                                                                                                                    
Star Wars: Episodio IV                                    1978 Aventura, Drama, Historia, Romance                              1                                                                                                                                                                                                                                                                                                                                                                                    
Avengers: Endgame                                         1985 Comedia, Crimen, Historia, Terror                               2                                                                                                                                                                                                                                                                                                                                                                                    
La lista de Schindler                                     1990 Ciencia, Comedia, Crimen, Drama                                 2                                                                                                                                                                                                                                                                                                                                                                                    
Iron Man                                                  1996 Biografía, Ciencia ficción, Comedia, Crimen                   5                                                                                                                                                                                                                                                                                                                                                                                    
Titanic                                                   1982 Aventura, Ciencia, Crimen, Drama                                3                                                                                                                                                                                                                                                                                                                                                                                    
The Lost World: Jurassic Park                             1969 Acción, Ciencia, Crimen, Drama                                 2                                                                                                                                                                                                                                                                                                                                                                                    
El Señor de los Anillos: El retorno del rey              1962 Ciencia, Ciencia ficción, Comedia, Naturaleza                  2                                                                                                                                                                                                                                                                                                                                                                                    
Star Wars: Episodio I                                     1997 Comedia, Drama, Historia, Romance                               2                                                                                                                                                                                                                                                                                                                                                                                    
Ciudadano Kane                                            1984 Ciencia ficción, Comedia, Historia, Naturaleza                 4                                                                                                                                                                                                                                                                                                                                                                                    
Fast and Furious 6                                        1967 Ciencia, Comedia, Romance, Terror                               3                                                                                                                                                                                                                                                                                                                                                                                    
Avatar                                                    1976 Aventura, Biografía, Romance, Terror                           1                                                                                                                                                                                                                                                                                                                                                                                    
El caballero oscuro                                       1982 Aventura, Biografía, Romance, Terror                           1                                                                                                                                                                                                                                                                                                                                                                                    
Los juegos del hambre                                     1997 Biografía, Comedia, Drama, Naturaleza                          5                                                                                                                                                                                                                                                                                                                                                                                    
The Fast and the Furious                                  1976 Acción, Biografía, Ciencia ficción, Romance                  2                                                                                                                                                                                                                                                                                                                                                                                    
Thunderball                                               1971 Comedia, Drama, Historia, Romance                               2                                                                                                                                                                                                                                                                                                                                                                                    
La Cámara Secreta                                        1986 Aventura, Ciencia ficción, Historia, Romance                   1                                                                                                                                                                                                                                                                                                                                                                                    
Dr. No                                                    1969 Aventura, Ciencia, Crimen, Drama                                5                                                                                                                                                                                                                                                                                                                                                                                    
Star Wars: Episodio VI                                    1975 Aventura, Ciencia ficción, Crimen, Historia                    1                                                                                                                                                                                                                                                                                                                                                                                    
Sinsajo - Parte 1                                         1977 Aventura, Biografía, Romance, Terror                           3                                                                                                                                                                                                                                                                                                                                                                                    
Avengers: Infinity War                                    1995 Acción, Ciencia, Drama, Romance                                1                                                                                                                                                                                                                                                                                                                                                                                    
El padrino                                                1982 Ciencia, Comedia, Crimen, Terror                                1                                                                                                                                                                                                                                                                                                                                                                                    
El Señor de los Anillos: Las dos torres                  1970 Comedia, Crimen, Drama, Historia                                3                                                                                                                                                                                                                                                                                                                                                                                    
Goldfinger                                                1988 Acción, Biografía, Naturaleza, Terror                         5                                                                                                                                                                                                                                                                                                                                                                                    
Casablanca                                                1964 Ciencia, Comedia, Crimen, Drama                                 3                                                                                                                                                                                                                                                                                                                                                                                    
La vida es bella                                          1975 Aventura, Ciencia, Crimen, Terror                               4                                                                                                                                                                                                                                                                                                                                                                                    
Pulp Fiction                                              1967 Aventura, Ciencia, Ciencia ficción, Romance                    2                                                                                                                                                                                                                                                                                                                                                                                    
Harry Potter                                              1989 Biografía, Comedia, Crimen, Terror                             1                                                                                                                                                                                                                                                                                                                                                                                    
Indiana Jones: En busca del arca perdida                  1976 Comedia, Drama, Historia, Naturaleza                            3                                                                                                                                                                                                                                                                                                                                                                                    
Jurassic Park                                             1979 Acción, Ciencia, Ciencia ficción, Romance                     2                                                                                                                                                                                                                                                                                                                                                                                    
La forma del agua                                         1982 Comedia, Historia, Romance, Terror                              1                                                                                                                                                                                                                                                                                                                                                                                    
El Senor de los Anillos: La Comunidad del Anillo          1989 Acción, Ciencia, Naturaleza, Terror                            2                                                                                                                                                                                                                                                                                                                                                                                    
El Prisionero de Azkaban                                  1963 Aventura, Biografía, Crimen, Drama                             1                                                                                                                                                                                                                                                                                                                                                                                    
El laberinto del fauno                                    1970 Biografía, Comedia, Crimen, Terror                             1                                                                                                                                                                                                                                                                                                                                                                                    

35 rows selected.

SQL> start 5
SQL> --5
SQL> SELECT s.title Titulo, EXTRACT(YEAR FROM s.begin_date) Lanzamiento, s.seasons Temporadas, COUNT(DISTINCT rs.id) Reproducciones
  2  FROM serie s
  3  INNER JOIN serie_language sl ON sl.serie_id = s.id
  4  INNER JOIN reproduction_serie rs ON rs.serie_language_id = sl.id
  5  INNER JOIN client c ON c.id = rs.client_id
  6  GROUP BY s.title, s.seasons, s.begin_date
  7  ORDER BY Lanzamiento, Titulo;

TITULO                                             LANZAMIENTO TEMPORADAS REPRODUCCIONES                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------------------------------------- ----------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                            
Vikings                                                   1963          3              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Chernobyl                                                 1965          9              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Westworld                                                 1965          7              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Star Trek The Next Generation                             1966          4              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Arrow                                                     1967          4              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Hawkeye                                                   1967          5              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Juego de Tronos                                           1967          7              4                                                                                                                                                                                                                                                                                                                                                                                                                            
The Simpsons                                              1967          8              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Black Mirror                                              1968          1              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Narcos                                                    1968          1              4                                                                                                                                                                                                                                                                                                                                                                                                                            
The Flash                                                 1968          4              1                                                                                                                                                                                                                                                                                                                                                                                                                            
The Mandalorian                                           1968          4              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Money Heist                                               1969          6              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Legends of Tomorrow                                       1974          6              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Star Trek The Original Series                             1974          5              1                                                                                                                                                                                                                                                                                                                                                                                                                            
True Detective                                            1976          7              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Stranger Things                                           1977          8              2                                                                                                                                                                                                                                                                                                                                                                                                                            
The Office                                                1979          1              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Law and Order                                             1980          1              5                                                                                                                                                                                                                                                                                                                                                                                                                            
The Crown                                                 1982          9              4                                                                                                                                                                                                                                                                                                                                                                                                                            
How I Met Your Mother                                     1989          9              4                                                                                                                                                                                                                                                                                                                                                                                                                            
WandaVision                                               1989         10              2                                                                                                                                                                                                                                                                                                                                                                                                                            
CSI: Las Vegas                                            1990          1              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Loki                                                      1993          8              3                                                                                                                                                                                                                                                                                                                                                                                                                            
Peaky Blinders                                            1993          9              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Greys Anatomy                                             1995          8              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Law and Order: Special Victims Unit                       1997          5              1                                                                                                                                                                                                                                                                                                                                                                                                                            
The Walking Dead                                          2011          4              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Fear the Walking Dead                                     2015          9              3                                                                                                                                                                                                                                                                                                                                                                                                                            

29 rows selected.

SQL> start 6
SQL> --6
SQL> SELECT d.title Titulo, EXTRACT(YEAR FROM d.begin_date) Lanzamiento, d.seasons Temporadas, COUNT(DISTINCT rd.id) Reproducciones
  2  FROM documentary d
  3  INNER JOIN documentary_language dl ON dl.documentary_id = d.id
  4  INNER JOIN reproduction_documentary rd ON rd.documentary_language_id = dl.id
  5  INNER JOIN client c ON c.id = rd.client_id
  6  GROUP BY d.title, d.seasons, d.begin_date
  7  ORDER BY Lanzamiento, Titulo;

TITULO                                             LANZAMIENTO TEMPORADAS REPRODUCCIONES                                                                                                                                                                                                                                                                                                                                                                                                                            
-------------------------------------------------- ----------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                            
13th                                                      1960          4              1                                                                                                                                                                                                                                                                                                                                                                                                                            
UFO                                                       1960          2              1                                                                                                                                                                                                                                                                                                                                                                                                                            
RBG                                                       1961          4              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Amy                                                       1962          1              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Free Solo                                                 1964          4              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Planet Earth II:                                          1964          2              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Icarus                                                    1967          4              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Senna                                                     1971          1              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Jiro Dreams of Sushi                                      1973          1              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Citizenfour                                               1974          4              2                                                                                                                                                                                                                                                                                                                                                                                                                            
March of the Penguins                                     1974          2              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Tiny House Nation                                         1978          3              4                                                                                                                                                                                                                                                                                                                                                                                                                            
Blackfish                                                 1979          2              3                                                                                                                                                                                                                                                                                                                                                                                                                            
Blue Planet II:                                           1985          2              3                                                                                                                                                                                                                                                                                                                                                                                                                            
Cosmos                                                    1985          3              3                                                                                                                                                                                                                                                                                                                                                                                                                            
O.J.                                                      1985          4              2                                                                                                                                                                                                                                                                                                                                                                                                                            
The Cove                                                  1990          3              5                                                                                                                                                                                                                                                                                                                                                                                                                            
The Act of Killing                                        1991          3              3                                                                                                                                                                                                                                                                                                                                                                                                                            
Hoop Dreams                                               1992          2              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Planet Earth                                              1992          1              2                                                                                                                                                                                                                                                                                                                                                                                                                            
Searching for Sugar Man                                   1993          3              1                                                                                                                                                                                                                                                                                                                                                                                                                            
Voyager in Space                                          1993          3              3                                                                                                                                                                                                                                                                                                                                                                                                                            
A Spacetime Odyssey                                       1994          3              2                                                                                                                                                                                                                                                                                                                                                                                                                            

23 rows selected.

SQL> start 7
SQL> SELECT * FROM (
  2    SELECT 'Pelicula' Tipo, m.title Titulo, EXTRACT(YEAR FROM m.year) Lazamiento, m.length Duracion, COUNT(1) Descargas, MAX(dm.begin_date) "ULT. DESC."
  3    FROM download_movie dm
  4    INNER JOIN movie_language ml ON ml.id = dm.movie_language_id
  5    INNER JOIN movie m ON m.id = ml.movie_id
  6    GROUP BY m.title, m.year, m.length
  7    UNION
  8    SELECT 'Serie' Tipo, s.title Titulo, EXTRACT(YEAR FROM s.begin_date) Lazamiento, s.length Duracion, COUNT(1) Descargas, MAX(ds.begin_date) "ULT. DESC."
  9    FROM download_serie ds
 10    INNER JOIN serie_language sl ON sl.id = ds.serie_language_id
 11    INNER JOIN serie s ON s.id = sl.serie_id
 12    GROUP BY s.title, s.begin_date, s.length
 13    UNION
 14    SELECT 'Documental' Tipo, d.title Titulo, EXTRACT(YEAR FROM d.begin_date) Lazamiento, d.length Duracion, COUNT(1) Descargas, MAX(dd.begin_date) "ULT. DESC."
 15    FROM download_documentary dd
 16    INNER JOIN documentary_language dl ON dl.id = dd.documentary_language_id
 17    INNER JOIN documentary d ON d.id = dl.documentary_id
 18    GROUP BY d.title, d.begin_date, d.length
 19  )
 20  ORDER BY Descargas DESC;

TIPO       TITULO                                             LAZAMIENTO   DURACION  DESCARGAS ULT. DESC                                                                                                                                                                                                                                                                                                                                                                                                            
---------- -------------------------------------------------- ---------- ---------- ---------- ---------                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Harry Potter                                             1989        122          3 22-OCT-21                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Titanic                                                  1982        142          3 10-JAN-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Avengers: Endgame                                        1985        183          3 19-NOV-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Sinsajo - Parte 1                                        1977        175          2 17-AUG-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El Señor de los Anillos: El retorno del rey             1962        137          2 04-FEB-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   La vida es bella                                         1975        179          2 26-OCT-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Fast Five                                                1964        182          2 09-AUG-21                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Friends                                                  1987        375          2 01-APR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Dr. No                                                   1969        188          2 11-JUN-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      CSI: Las Vegas                                           1990        450          2 23-MAY-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Jurassic Park                                            1979        190          2 26-JUN-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Money Heist                                              1969        464          2 06-JUN-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Thunderball                                              1971        158          2 05-APR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Iron Man                                                 1996        141          2 04-NOV-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      The Walking Dead                                         2011        476          2 10-SEP-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El gran Lebowski                                         1963        171          1 10-NOV-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El laberinto del fauno                                   1970        160          1 23-DEC-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El padrino                                               1982        191          1 07-AUG-21                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Fast and Furious 6                                       1967        166          1 13-APR-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Forrest Gump                                             1997        173          1 15-FEB-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   La Cámara Secreta                                       1986        163          1 14-MAR-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   La forma del agua                                        1982        160          1 14-FEB-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   La lista de Schindler                                    1990        198          1 02-MAR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Los juegos del hambre                                    1997        151          1 01-MAR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Star Wars: Episodio VI                                   1975        185          1 17-NOV-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Arrow                                                    1967        247          1 12-MAR-21                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Breaking Bad                                             1985        229          1 06-SEP-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      CSI: Miami                                               1973        340          1 04-MAR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Greys Anatomy                                            1995        446          1 24-JAN-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      How I Met Your Mother                                    1989        595          1 03-APR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Juego de Tronos                                          1967        214          1 05-SEP-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Loki                                                     1993        424          1 08-SEP-23                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Lost                                                     1966        151          1 02-NOV-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Stranger Things                                          1977        225          1 18-JUL-21                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      The Office                                               1979        526          1 22-APR-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      WandaVision                                              1989        193          1 14-JUN-21                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El caballero oscuro                                      1982        191          1 24-JUN-23                                                                                                                                                                                                                                                                                                                                                                                                            

TIPO       TITULO                                             LAZAMIENTO   DURACION  DESCARGAS ULT. DESC                                                                                                                                                                                                                                                                                                                                                                                                            
---------- -------------------------------------------------- ---------- ---------- ---------- ---------                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   El Padrino II                                            1987        195          1 14-AUG-22                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Ciudadano Kane                                           1984        167          1 19-SEP-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Casablanca                                               1964        174          1 06-MAR-23                                                                                                                                                                                                                                                                                                                                                                                                            
Pelicula   Avatar                                                   1976        161          1 16-FEB-22                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Voyager in Space                                         1993        164          1 04-JUL-21                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Tiny House Nation                                        1978        584          1 06-SEP-21                                                                                                                                                                                                                                                                                                                                                                                                            
Documental The Phenomenon                                           1974        344          1 15-MAY-22                                                                                                                                                                                                                                                                                                                                                                                                            
Documental The Cove                                                 1990        552          1 17-JUL-21                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Senna                                                    1971        424          1 16-OCT-23                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Searching for Sugar Man                                  1993        401          1 22-MAR-23                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Icarus                                                   1967        334          1 25-NOV-22                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Blue Planet II:                                          1985        110          1 02-OCT-22                                                                                                                                                                                                                                                                                                                                                                                                            
Serie      Westworld                                                1965        402          1 20-SEP-23                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Amy                                                      1962        373          1 14-JAN-21                                                                                                                                                                                                                                                                                                                                                                                                            
Documental Blackfish                                                1979        457          1 21-MAY-21                                                                                                                                                                                                                                                                                                                                                                                                            

52 rows selected.

SQL> start 8
SQL> SELECT name || ' ' || last_name "NOMBRE COMPLETO",
  2  EXTRACT(YEAR FROM inclusion) Suscripcion,
  3  SUM(repro) "PELICULAS REPRODUCIDAS",
  4  SUM(downloads) "TOTAL DESC.",
  5  last_movie_title "TITULO ULT. PELICULA.",
  6  MAX(last_reproduction) "ULT. REPR."
  7  FROM (
  8    SELECT c.id, c.name, c.last_name, c.inclusion,
  9    COUNT(DISTINCT CASE WHEN dm.client_id = c.id THEN dm.id END) downloads,
 10    COUNT(DISTINCT CASE WHEN rm.client_id = c.id THEN rm.id END) repro,
 11    MAX(rm.begin_date) last_reproduction
 12    FROM client c
 13    LEFT JOIN download_movie dm ON dm.client_id = c.id
 14    LEFT JOIN reproduction_movie rm ON rm.client_id = c.id
 15    GROUP BY c.id, c.name, c.last_name, c.inclusion
 16    UNION
 17    SELECT c.id, c.name, c.last_name, c.inclusion,
 18    COUNT(DISTINCT CASE WHEN ds.client_id = c.id THEN ds.id END) downloads, 0,
 19    MAX(rs.begin_date) last_reproduction
 20    FROM client c
 21    LEFT JOIN download_serie ds ON ds.client_id = c.id
 22    LEFT JOIN reproduction_serie rs ON rs.client_id = c.id
 23    GROUP BY c.id, c.name, c.last_name, c.inclusion
 24    UNION
 25    SELECT c.id, c.name, c.last_name, c.inclusion,
 26    COUNT(DISTINCT CASE WHEN dd.client_id = c.id THEN dd.id END) downloads, 0,
 27    MAX(rd.begin_date) last_reproduction
 28    FROM client c
 29    LEFT JOIN download_documentary dd ON dd.client_id = c.id
 30    LEFT JOIN reproduction_documentary rd ON rd.client_id = c.id
 31    GROUP BY c.id, c.name, c.last_name, c.inclusion
 32  ) t
 33  LEFT JOIN (
 34    SELECT rm.client_id, m.title AS last_movie_title
 35    FROM reproduction_movie rm
 36    INNER JOIN movie_language ml ON ml.id = rm.movie_language_id
 37    INNER JOIN movie m ON m.id = ml.movie_id
 38    WHERE rm.begin_date = (
 39  	 SELECT MAX(rm_inner.begin_date)
 40  	 FROM reproduction_movie rm_inner
 41  	 WHERE rm_inner.client_id = rm.client_id
 42    )
 43  ) r ON r.client_id = t.id
 44  GROUP BY name, last_name, EXTRACT(YEAR FROM inclusion), last_movie_title
 45  ORDER BY last_name;

NOMBRE COMPLETO                                               SUSCRIPCION PELICULAS REPRODUCIDAS TOTAL DESC. TITULO ULT. PELICULA.                              ULT. REPR                                                                                                                                                                                                                                                                                                                                           
------------------------------------------------------------- ----------- ---------------------- ----------- -------------------------------------------------- ---------                                                                                                                                                                                                                                                                                                                                           
Wálter Abella                                                       2013                      1           1 Dr. No                                             12-NOV-23                                                                                                                                                                                                                                                                                                                                           
Maricela Abril Millán Molins                                        2009                      1           2 Indiana Jones: En busca del arca perdida           03-NOV-22                                                                                                                                                                                                                                                                                                                                           
Nando Amo Pol                                                        2014                      1           2 La vida es bella                                   18-OCT-23                                                                                                                                                                                                                                                                                                                                           
Teodosio Américo Trillo Neira                                       2012                      1           2 El padrino                                         15-OCT-23                                                                                                                                                                                                                                                                                                                                           
José Antonio Carbó Sierra                                          2014                      2           3 Sinsajo - Parte 1                                  12-FEB-23                                                                                                                                                                                                                                                                                                                                           
Plácido Asensio Arteaga                                             2011                      0           2                                                    10-APR-22                                                                                                                                                                                                                                                                                                                                           
Alejandra Barrera Neira                                              2009                      2           1 The Fast and the Furious                           11-OCT-23                                                                                                                                                                                                                                                                                                                                           
Paola Bartolomé-Ferrer                                              2021                      1           1 La vida es bella                                   16-DEC-22                                                                                                                                                                                                                                                                                                                                           
Javiera Bermudez                                                     2018                      1           1 Titanic                                            01-MAR-23                                                                                                                                                                                                                                                                                                                                           
Magdalena Bermúdez Prat                                             2016                      2           3 Los juegos del hambre                              18-JAN-23                                                                                                                                                                                                                                                                                                                                           
Anna Bernal Jover                                                    2017                      2           1 Avengers: Endgame                                  25-JUL-23                                                                                                                                                                                                                                                                                                                                           
Adelaida Borrás Rosado                                              2014                      3           3 Jurassic Park                                      20-AUG-23                                                                                                                                                                                                                                                                                                                                           
Modesto Botella Campo                                                2009                      1           5 Avengers: Endgame                                  12-OCT-23                                                                                                                                                                                                                                                                                                                                           
Miriam Briones Calvet                                                2011                      1           1 Los juegos del hambre                              17-NOV-23                                                                                                                                                                                                                                                                                                                                           
Fabiola Bustamante Valbuena                                          2011                      1           1 Goldfinger                                         12-DEC-21                                                                                                                                                                                                                                                                                                                                           
Vidal Carbonell Almansa                                              2009                      5           0 Goldfinger                                         21-DEC-23                                                                                                                                                                                                                                                                                                                                           
Ángel Castellanos Heras                                             2010                      0           3                                                    21-NOV-23                                                                                                                                                                                                                                                                                                                                           
Jesús Castells Flor                                                 2021                      1           3 Goldfinger                                         19-NOV-23                                                                                                                                                                                                                                                                                                                                           
Julián Cervantes                                                    2019                      0           2                                                    08-MAR-23                                                                                                                                                                                                                                                                                                                                           
Caridad Clemente Lara                                                2022                      1           1 Avengers: Infinity War                             07-NOV-23                                                                                                                                                                                                                                                                                                                                           
Flavia Dominguez Mínguez                                            2017                      1           1 Goldfinger                                         22-SEP-23                                                                                                                                                                                                                                                                                                                                           
Maricela Duque Pomares                                               2016                      2           0 El Señor de los Anillos: Las dos torres           16-MAR-23                                                                                                                                                                                                                                                                                                                                           
Celso España Somoza                                                 2020                      1           1 The Lost World: Jurassic Park                      03-JUN-21                                                                                                                                                                                                                                                                                                                                           
Francisca Esther Solís Guzman                                       2015                      2           0 Star Wars: Episodio IV                             20-AUG-23                                                                                                                                                                                                                                                                                                                                           
Armida Galiano Vélez                                                2012                      5           0 Thunderball                                        08-MAY-23                                                                                                                                                                                                                                                                                                                                           
Vilma Galindo Riba                                                   2019                      2           1 Iron Man                                           04-SEP-22                                                                                                                                                                                                                                                                                                                                           
Chus Gomez Martín                                                   2018                      0           1                                                    17-JUL-21                                                                                                                                                                                                                                                                                                                                           
Haroldo Grande Ballesteros                                           2016                      3           1 El Senor de los Anillos: La Comunidad del Anillo   20-AUG-23                                                                                                                                                                                                                                                                                                                                           
Jesús Leal Jaume                                                    2015                      3           2 La lista de Schindler                              13-APR-23                                                                                                                                                                                                                                                                                                                                           
Visitación Malena Cuervo Bravo                                      2022                      1           0 El Señor de los Anillos: Las dos torres           13-SEP-23                                                                                                                                                                                                                                                                                                                                           
Victor Manuel Urrutia-Baquero                                        2014                      0           1                                                    26-NOV-23                                                                                                                                                                                                                                                                                                                                           
Haydée Martin Pou                                                   2013                      2           1 Iron Man                                           08-AUG-22                                                                                                                                                                                                                                                                                                                                           
José María Oller Carrera                                           2012                      1           2 La Cámara Secreta                                 13-OCT-23                                                                                                                                                                                                                                                                                                                                           
Reyes Matas Morales                                                  2020                      1           2 El Señor de los Anillos: El retorno del rey       08-MAR-23                                                                                                                                                                                                                                                                                                                                           
Nélida Moles Pavón                                                 2018                      2           2 El Prisionero de Azkaban                           13-MAR-23                                                                                                                                                                                                                                                                                                                                           
Francisco Moreno Acedo                                               2012                      2           1 Harry Potter                                       12-MAR-23                                                                                                                                                                                                                                                                                                                                           
Abilio Nadal Contreras                                               2014                      2           2 Dr. No                                             15-SEP-23                                                                                                                                                                                                                                                                                                                                           

NOMBRE COMPLETO                                               SUSCRIPCION PELICULAS REPRODUCIDAS TOTAL DESC. TITULO ULT. PELICULA.                              ULT. REPR                                                                                                                                                                                                                                                                                                                                           
------------------------------------------------------------- ----------- ---------------------- ----------- -------------------------------------------------- ---------                                                                                                                                                                                                                                                                                                                                           
Maxi Nerea Salas Morante                                             2011                      3           0 La vida es bella                                   26-JUN-23                                                                                                                                                                                                                                                                                                                                           
Sandra Plana Salazar                                                 2019                      1           3 Ciudadano Kane                                     12-OCT-23                                                                                                                                                                                                                                                                                                                                           
Olegario Prieto-Quevedo                                              2019                      1           3 La forma del agua                                  19-JUL-23                                                                                                                                                                                                                                                                                                                                           
Jeremías Pérez-Vilalta                                             2020                      2           0 Sinsajo - Parte 1                                  03-APR-23                                                                                                                                                                                                                                                                                                                                           
Carlos Rey Martí                                                    2017                      3           2 Fast and Furious 6                                 17-DEC-23                                                                                                                                                                                                                                                                                                                                           
Pelayo Rovira Baeza                                                  2018                      1           1 The Lost World: Jurassic Park                      09-AUG-23                                                                                                                                                                                                                                                                                                                                           
Gerardo Salas Valenzuela                                             2016                      3           0 Los juegos del hambre                              07-DEC-23                                                                                                                                                                                                                                                                                                                                           
Fulgencio Sebastián Santiago                                        2009                      2           0 Titanic                                            25-DEC-23                                                                                                                                                                                                                                                                                                                                           
Alejandra Susanita Franch Casal                                      2010                      1           0 Casablanca                                         23-DEC-21                                                                                                                                                                                                                                                                                                                                           
Candelaria Tamarit                                                   2015                      0           2                                                    09-AUG-23                                                                                                                                                                                                                                                                                                                                           
Porfirio de Calatayud                                                2013                      3           2 Los juegos del hambre                              10-SEP-23                                                                                                                                                                                                                                                                                                                                           
Fátima de Company                                                   2019                      1           1 Ciudadano Kane                                     20-APR-23                                                                                                                                                                                                                                                                                                                                           
María Ángeles Bonilla-Río                                         2017                      2           0 Pulp Fiction                                       02-SEP-23                                                                                                                                                                                                                                                                                                                                           

50 rows selected.

SQL> start 9
SQL> SELECT ROWNUM Top, r.* FROM (
  2    SELECT Titulo, Tipo, Reproducciones, Descargas, last_reproduction "ULT. REPR.", last_download "ULT. DESC." FROM (
  3  	 SELECT 'Pelicula' Tipo, m.title Titulo,
  4  	   COUNT(DISTINCT dm.id) Descargas,
  5  	   COUNT(DISTINCT rm.id) Reproducciones,
  6  	   MAX(rm.begin_date) last_reproduction,
  7  	   MAX(dm.begin_date) last_download,
  8  	   COUNT(DISTINCT dm.id) + COUNT(DISTINCT rm.id) Total
  9  	   FROM movie m
 10  	   LEFT JOIN movie_language ml ON ml.movie_id = m.id
 11  	   LEFT JOIN download_movie dm ON dm.movie_language_id = ml.id
 12  	   LEFT JOIN reproduction_movie rm ON rm.movie_language_id = ml.id
 13  	   HAVING COUNT(DISTINCT dm.id) > 0 OR COUNT(DISTINCT rm.id) > 0
 14  	   GROUP BY m.title
 15  	 UNION
 16  	 SELECT 'Serie' Tipo, s.title Titulo,
 17  	   COUNT(DISTINCT ds.id) Descargas,
 18  	   COUNT(DISTINCT rs.id) Reproducciones,
 19  	   MAX(rs.begin_date) last_reproduction,
 20  	   MAX(ds.begin_date) last_download,
 21  	   COUNT(DISTINCT ds.id) + COUNT(DISTINCT rs.id) Total
 22  	   FROM serie s
 23  	   LEFT JOIN serie_language sl ON sl.serie_id = s.id
 24  	   LEFT JOIN download_serie ds ON ds.serie_language_id = sl.id
 25  	   LEFT JOIN reproduction_serie rs ON rs.serie_language_id = sl.id
 26  	   HAVING COUNT(DISTINCT ds.id) > 0 OR COUNT(DISTINCT rs.id) > 0
 27  	   GROUP BY s.title
 28  	 UNION
 29  	 SELECT 'Documental' Tipo, d.title Titulo,
 30  	   COUNT(DISTINCT dd.id) Descargas,
 31  	   COUNT(DISTINCT rd.id) Reproducciones,
 32  	   MAX(rd.begin_date) last_reproduction,
 33  	   MAX(dd.begin_date) last_download,
 34  	   COUNT(DISTINCT dd.id) + COUNT(DISTINCT rd.id) Total
 35  	   FROM documentary d
 36  	   LEFT JOIN documentary_language dl ON dl.documentary_id = d.id
 37  	   LEFT JOIN download_documentary dd ON dd.documentary_language_id = dl.id
 38  	   LEFT JOIN reproduction_documentary rd ON rd.documentary_language_id = dl.id
 39  	   GROUP BY d.title
 40    )
 41    ORDER BY Total DESC
 42  ) r
 43  WHERE ROWNUM <= 10;

       TOP TITULO                                             TIPO       REPRODUCCIONES  DESCARGAS ULT. REPR ULT. DESC                                                                                                                                                                                                                                                                                                                                                                                              
---------- -------------------------------------------------- ---------- -------------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                                                                                              
         1 Dr. No                                             Pelicula                5          2 15-OCT-23 11-JUN-22                                                                                                                                                                                                                                                                                                                                                                                              
         2 Iron Man                                           Pelicula                5          2 19-JUN-23 04-NOV-23                                                                                                                                                                                                                                                                                                                                                                                              
         3 The Cove                                           Documental              5          1 01-JUN-23 17-JUL-21                                                                                                                                                                                                                                                                                                                                                                                              
         4 Titanic                                            Pelicula                3          3 25-DEC-23 10-JAN-23                                                                                                                                                                                                                                                                                                                                                                                              
         5 Los juegos del hambre                              Pelicula                5          1 21-JAN-23 01-MAR-22                                                                                                                                                                                                                                                                                                                                                                                              
         6 La vida es bella                                   Pelicula                4          2 26-JUN-23 26-OCT-22                                                                                                                                                                                                                                                                                                                                                                                              
         7 Tiny House Nation                                  Documental              4          1 10-AUG-23 06-SEP-21                                                                                                                                                                                                                                                                                                                                                                                              
         8 Goldfinger                                         Pelicula                5          0 21-DEC-23                                                                                                                                                                                                                                                                                                                                                                                                        
         9 Ciudadano Kane                                     Pelicula                4          1 12-OCT-23 19-SEP-23                                                                                                                                                                                                                                                                                                                                                                                              
        10 Avengers: Endgame                                  Pelicula                2          3 25-JUL-23 19-NOV-23                                                                                                                                                                                                                                                                                                                                                                                              

10 rows selected.

SQL> start 10
SQL> SELECT g.name Genero,
  2  COUNT(DISTINCT m.id) Peliculas,
  3  COUNT(DISTINCT s.id) Series,
  4  EXTRACT(YEAR FROM MIN(m.year)) "PRIMER PELICULA",
  5  EXTRACT(YEAR FROM MIN(s.begin_date)) "PRIMER SERIE"
  6  FROM genre g
  7  LEFT JOIN movie_genre mg ON mg.genre_id = g.id
  8  LEFT JOIN movie m ON m.id = mg.movie_id
  9  LEFT JOIN serie_genre sg ON sg.genre_id = g.id
 10  LEFT JOIN serie s ON s.id = sg.serie_id
 11  GROUP BY g.name
 12  ORDER BY MIN(m.year) ASC;

GENERO                PELICULAS     SERIES PRIMER PELICULA PRIMER SERIE                                                                                                                                                                                                                                                                                                                                                                                                                                             
-------------------- ---------- ---------- --------------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                             
Comedia                      21         20            1962         1962                                                                                                                                                                                                                                                                                                                                                                                                                                             
Naturaleza                    7         19            1962         1965                                                                                                                                                                                                                                                                                                                                                                                                                                             
Ciencia ficción             11         14            1962         1965                                                                                                                                                                                                                                                                                                                                                                                                                                             
Ciencia                      16         10            1962         1966                                                                                                                                                                                                                                                                                                                                                                                                                                             
Crimen                       17         16            1963         1962                                                                                                                                                                                                                                                                                                                                                                                                                                             
Drama                        16         12            1963         1965                                                                                                                                                                                                                                                                                                                                                                                                                                             
Biografía                   10         17            1963         1963                                                                                                                                                                                                                                                                                                                                                                                                                                             
Aventura                     12          9            1963         1963                                                                                                                                                                                                                                                                                                                                                                                                                                             
Romance                      16          5            1964         1966                                                                                                                                                                                                                                                                                                                                                                                                                                             
Terror                       13         14            1967         1962                                                                                                                                                                                                                                                                                                                                                                                                                                             
Acción                       7         11            1969         1967                                                                                                                                                                                                                                                                                                                                                                                                                                             
Historia                     14         13            1970         1962                                                                                                                                                                                                                                                                                                                                                                                                                                             

12 rows selected.

SQL> spool off
